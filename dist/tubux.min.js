/*!
 * Tubux v1.0.1
 * https://github.com/thomasperi/tubux#readme
 * Thomas Peri <hello@thomasperi.net>
 * MIT License
 */
!function(n){!function(n,t){"use strict";var e,i,r,o="$$",u="hasOwnProperty",s="noConflict",c="object",f="function"==typeof define&&define,l=typeof exports===c&&exports,a=typeof module===c&&module;f&&f.amd&&typeof f.amd===c?define([],n):a&&l===t&&l===a.exports?module.exports=n():((r=t[u](o))&&(i=t.$$),t.$$=e=n(),e[u](s)||(e[s]=function(){return r?t.$$=i:delete t.$$,e[s]=function(){return e},e}))}(function(){"use strict";var n="this accessor is write-only",t="this accessor is read-only",e="this accessor is hidden",i="this accessor is required",r="this flag is only available after applying the .accessor() flag",o="assigning $$(...) values to the prototype is not allowed",u="hasOwnProperty",s="prototype",c="function",f={};function l(n){return new $(n)}function a(n){return O(arguments,function(t){y(t,function(t,e){n[t]=e})},1),n}function h(n){y(n,function(n,t){delete t.secret})}function d(n,t,e){if(n[u](t))return n[t]instanceof $?n[t].value=e:n[t]=e,!0}function p(n,t){return y(n,function(e,i){var r=v(i,"filter");r&&(i.value=r(i.value)),v(i,"accessor")?n[e]=t[e]=i.generate(n,e):i instanceof $&&(n[e]=i.value)}),t}function g(n){return typeof n===c?n:null}function v(n,t){return n instanceof $&&n.get_internal(f)[t]}function y(n,t){for(var e in n)n[u](e)&&t(e,n[e]);return n}function O(n,t,e,i){var r,o=i||n.length;for(r=e||0;r<o;r++)t(n[r],r);return n}function $(n){var t={};n instanceof $&&(a(t,n.get_internal(f)),n=n.value,t.listen&&(t.listen=[].slice.call(t.listen))),a(this,{value:n,set_internal:function(n,e,i){n===f&&(t[e]=i)},get_internal:function(n){if(n===f)return t}})}function w(n,t){return this.get_internal(f).accessor||m(r,t)(),n}function m(n,t){return function(){throw{message:n,key:t}}}return a(l,{assign:a,struct:function(n){var t=(n=a({},{params:{},proto:{},statics:{},construct:null},n)).params,e=g(n.construct);function r(n){var r=this,o={},s={};n="object"==typeof n&&n||{},y(t,function(t,e){v(e,"required")&&!n[u](t)&&m(i,t)(),e instanceof $&&(e=new $(e)),v(e,"secret")?s[t]=e:r[t]=e}),y(n,function(n,t){d(r,n,t)||d(s,n,t)}),p(r,o),p(s,o),y(o,function(n,t){s[u](n)&&(s[n]=t.secret())}),e&&e.call(r,s),h(o)}return y(n.proto,function(n,t){t instanceof $&&m(o,n)()}),a(r[s],n.proto),a(r,n.statics),h(p(r,{})),r},secret:function(n){return y(n,function(t,e){e instanceof $||(e=n[t]=l(e)),e.secret()})},errors:{WRITEONLY:n,READONLY:t,HIDDEN:e,REQUIRED:i,ACCESSORONLY:r,PROTOPROXY:o},debug:!1}),function(n,t){y(t,function(t,e){n[t]=function(n){return arguments.length||(n=!0),this.set_internal(f,t,e?e.call(this,n,t):n),this}})}($[s],{accessor:null,required:null,secret:null,readonly:w,writeonly:w,hidden:w,filter:g,listen:function(n){w.call(this,n,"listen");var t=this.get_internal(f).listen||[];return(n=g(n))&&t.indexOf(n)<0&&t.push(n),t}}),a($[s],{generate:function(i,r){var o,u=this.get_internal(f),s=u.hidden,c=!u.writeonly&&!s,l=!u.readonly&&!s,h=u.filter,d=u.listen||[],p=m(e,r),v=m(t,r),y=m(n,r),$=l&&c?_:l?function(){if(0<arguments.length)return w(arguments[0]),o;y()}:c?function(){if(0===arguments.length)return o;v()}:function(){p()};function w(n){o!==(o=h?h(n):n)&&b.publish()}function _(){return 0<arguments.length&&w(arguments[0]),o}var b={secret:function(){return _},publish:function(){return d&&O(d,function(n){n&&n.call(i,o)}),this},filter:function(n){return h=g(n),_(o),this},listen:function(n){return d.indexOf(n)<0&&d.push(n),this},unlisten:function(n){var t=d.indexOf(n);return 0<=t&&d.splice(t,1),this}};return a($,b),a(_,b),l&&c||($.filter=c?v:l?y:p),c||($.listen=l?y:p),_(this.value),$}}),l.debug&&console.log(void 0),l},n)}(this);